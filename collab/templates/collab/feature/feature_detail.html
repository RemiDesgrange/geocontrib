
<div id="feature_detail">
    {% if rights.feat_modification or request.user.id == feature.user_id  %}
        <!-- <i id="btn_feature_subscribe" class="big icons">
            <i class="blue envelope outline icon "></i>
            <i class="mini at icon "></i>
        </i> -->
        <span id="btn_feature_edit"   data-tooltip="Modifier le signalement">
            <i class="orange big edit icon "></i>
        </span>
        <span id="btn_feature_delete"  data-tooltip="Supprimer le signalement" >
            <i  class="trash red big alternate icon "></i>
        </span>
        <span id="btn_feature_subscribe" data-tooltip="Abonnez-vous aux Modifications" >
            <i class="big blue envelope outline icon "></i>
        </span>
    {% endif %}
    <table class="ui very basic table">
        <tbody>
          {% for key,val in feature.items %}
              {% if key|display_key %}
                <tr>
                  <td><strong>{{labels|get_dict_item:key}}</strong></td>
                  {% if val %}
                      {% if val == True %}
                        <td><i class="green check icon"></td>
                      {% elif val == False %}
                        <td><i class="inverted red remove icon"></td>
                      {% else %}
                        <td>{{val|feature_val_display}}</td>
                      {% endif %}
                  {% else %}
                      <td><i class="minus icon"></td>
                  {% endif %}
                </tr>
              {% endif %}
          {% endfor %}
          <tr><td><strong>Auteur</strong></td>
              <td>{{author.username}}</td>
          <tr>
          <tr><td><strong>Signalements liés</strong></td>
              {%for row in feature_link %}
                <td>
                  {{row.get_relation_type_display}}: <a href="{% url 'project_feature_detail' project_slug=project.slug feature_type_slug=feature_type_slug feature_id=row.feature_to  %}" class="header">{{row.feature_to}}</a>
                </td>
              {% empty %}
                <td><i class="minus icon"></td>
              {% endfor %}
          <tr>
        </tbody>
    </table>
</div>

<div class="ui mini modal deletion">
      <div class="header">Suppression du signalement</div>
      <div class="content">
         <p>Êtes-vous sûr/sure de vouloir supprimer ce signalement&nbsp;?</p>
      </div>
      <div class="actions delete_actions">
          <div class="ui negative button">
            Non
          </div>
          <form action="{% url 'project_feature_detail' project_slug=project.slug feature_type_slug=request.resolver_match.kwargs.feature_type_slug feature_id=request.resolver_match.kwargs.feature_id %}" method='POST'>
              {% csrf_token %}
              <input type="hidden" name="_method" value="delete">
              <button type='submit' class="ui positive right labeled icon button">
                Oui
                <i class="checkmark icon"></i>
              </button>
          </form>
    </div>
</div>
<div class="ui mini modal subscription">
      <div class="header">Abonnement aux notifications</div>
      <i class="close icon"></i>
      <div class="content">
          <form action="{% url 'project_subscription' project_slug=project.slug feature_type_slug=request.resolver_match.kwargs.feature_type_slug feature_id=request.resolver_match.kwargs.feature_id %}" method='POST'>
              {% csrf_token %}
              <div class="inline field">
                   <div class="ui checkbox subscribe_checkbox">
                     <label>Inscription</label>
                     <input type="checkbox" tabindex="0" name="subscribe" class="hidden">
                   </div>
              </div>
              </br>
              <div class="actions">
                <button type='submit' class="ui positive right labeled icon button">
                  OK
                  <i class="checkmark icon"></i>
                </button>
              </div>
          </form>
      </div>

</div>
<script>
    // checkbox
    $('.ui.checkbox.subscribe_checkbox')
      .checkbox()
    ;

    var subscribe = "{{subscription}}"
    if (String(subscribe).toLowerCase() == 'true'){
        $('.ui.checkbox.subscribe_checkbox').checkbox('check');
    }
    // modal confirmation before subscription
    $('#btn_feature_subscribe').click(function(){
        $('.mini.modal.subscription')
          .modal('show')
        ;
    });

    // modal confirmation before deletion of feature
    $('#btn_feature_delete').click(function(){
        $('.mini.modal.deletion')
          .modal('show')
        ;
    });

    // modify type of cursor
    var edit_btn = document.getElementById("btn_feature_edit");
    edit_btn.style.cursor = "pointer";
    var delete_btn = document.getElementById("btn_feature_delete");
    delete_btn.style.cursor = "pointer";
    $("#btn_feature_edit").on('click', function(e) {
        url = ''
        $.ajax({
          url: url,
          type: 'GET',
          success: function (data) {
              $('#feature_detail').html("");
              $('#feature_menu').hide();
              $('#comments').hide();
              $('#attachments').hide();
              $('#events').hide();
              $('#edit_feature').html(data);
          },
          error: function(err) {
            console.log('Error occured', err);
          }
        });
    });

</script>
